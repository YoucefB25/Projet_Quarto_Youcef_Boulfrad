---
title: "TÃ©lÃ©chargement et PrÃ©paration du Dataset Covertype"
format: html
---
# PrÃ©sentation de la Base de DonnÃ©es Covertype

La base de donnÃ©es **Covertype** provient de l'[UCI Machine Learning Repository](https://archive.ics.uci.edu/ml/datasets/Covertype). Elle est utilisÃ©e pour **classer les types de couvert forestier** Ã  partir de mesures cartographiques (sol, altitude, pente, distance aux points d'eau, etc.).

## CaractÃ©ristiques du Dataset

- **Nombre d'observations** : 581 012
- **Nombre de variables** : 54 (features continues et binaires)
- **Nombre de classes** : 7 types de couverture forestiÃ¨re (1 Ã  7)
- **ProblÃ¨me Ã  rÃ©soudre** : Classification supervisÃ©e

Les classes ne sont **pas Ã©quilibrÃ©es**, ce qui peut influencer la performance des modÃ¨les de classification. Les proportions des classes dans lâ€™ensemble original sont les suivantes :

| Classe | Type de forÃªt                   | Effectif | Proportion (%) |
|--------|---------------------------------|-----------|---------------|
| 1      | Ã‰picÃ©a                          | 211 840   | 36.5          |
| 2      | Pin                             | 283 301   | 48.8          |
| 3      | Peuplier                        | 35 754    | 6.2           |
| 4      | Bouleau                         | 2 747     | 0.5           |
| 5      | Ã‰rable                          | 9 493     | 1.6           |
| 6      | HÃªtre                           | 17 367    | 3.0           |
| 7      | MÃ©lÃ¨ze                          | 18 510    | 3.2           |

---

## Objectif de l'Ã‰chantillonnage

### Pourquoi rÃ©duire la taille du dataset ?
Le dataset **Covertype est trÃ¨s grand** (581 012 individus). En raison du **temps de calcul important**, nous avons dÃ©cidÃ© d'utiliser un **Ã©chantillon plus petit**, tout en conservant la distribution des classes.

### Comment gÃ©rer le dÃ©sÃ©quilibre des classes ?
Certaines classes sont **trÃ¨s majoritaires** (ex : **Pin et Ã‰picÃ©a** reprÃ©sentent Ã  eux seuls **85% des donnÃ©es**), tandis que d'autres sont **trÃ¨s minoritaires** (ex : **Bouleau** Ã  seulement **0.5%**).  
Nous avons appliquÃ© un **Ã©chantillonnage diffÃ©renciÃ©** :

- **Sous-Ã©chantillonnage des classes majoritaires** (Ã‰picÃ©a et Pin) â†’ **5% de leurs effectifs d'origine**
- **Sur-Ã©chantillonnage relatif des classes minoritaires** (Peuplier, Bouleau, Ã‰rable, HÃªtre, MÃ©lÃ¨ze) â†’ **20% de leurs effectifs d'origine**

**Nous ne supprimons pas totalement le dÃ©sÃ©quilibre**, car nous souhaitons **tester nos modÃ¨les dans des conditions rÃ©alistes**, oÃ¹ certaines classes restent plus rares que d'autres.

L'Ã©chantillon obtenu comptera un peu plus de 40 000 individus, dont 60% seront rÃ©servÃ©s Ã  l'entrainement des modÃ¨les, 20% Ã  la validation des hyperparamÃ¨tres, et 20% aux tests.
---

## TÃ©lÃ©chargement et PrÃ©paration des DonnÃ©es

```{python}
import os
import pandas as pd
from sklearn.model_selection import train_test_split

# ğŸ“‚ Correction du chemin d'accÃ¨s au fichier dataset
file_path = "../data/covertype.gz"  # On remonte d'un dossier pour atteindre data/

if not os.path.exists(file_path):
    raise FileNotFoundError(f"âŒ Le fichier {file_path} est introuvable. VÃ©rifiez son emplacement.")

# ğŸ”„ Chargement des donnÃ©es
column_names = [f'Feature_{i}' for i in range(1, 55)] + ['Cover_Type']
data = pd.read_csv(file_path, header=None, names=column_names, compression='gzip')

# ğŸ”¢ Ã‰chantillonnage diffÃ©renciÃ©
sampling_rates = {1: 0.05, 2: 0.05, 3: 0.2, 4: 0.2, 5: 0.2, 6: 0.2, 7: 0.2}
sampled_data = pd.concat([
    data[data['Cover_Type'] == cls].sample(frac=sampling_rates[cls], random_state=42)
    for cls in data['Cover_Type'].unique()
]).reset_index(drop=True)

# ğŸ“Š Division en train/val/test
train_data, temp_data = train_test_split(sampled_data, test_size=0.4, random_state=42, stratify=sampled_data['Cover_Type'])
val_data, test_data = train_test_split(temp_data, test_size=0.5, random_state=42, stratify=temp_data['Cover_Type'])

# ğŸ“‚ Sauvegarde des fichiers dans data/
train_data.to_csv("../data/covertype_train.csv", index=False)
val_data.to_csv("../data/covertype_val.csv", index=False)
test_data.to_csv("../data/covertype_test.csv", index=False)

print("âœ… Fichiers covertype_train.csv, covertype_val.csv et covertype_test.csv crÃ©Ã©s avec succÃ¨s dans data/")


```

